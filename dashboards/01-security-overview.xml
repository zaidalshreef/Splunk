<dashboard version="1.1" theme="dark">
    <label>Security Overview</label>
    <description>SSH, Authentication, Failed Logins, Security Events</description>

    <row>
        <panel>
            <title>üîê Security Events (Last 24h)</title>
            <single>
                <search>
                    <query>index=security earliest=-24h | stats count</query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
                <option name="rangeValues">[100,500]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>‚ö†Ô∏è Failed Logins (Last 24h)</title>
            <single>
                <search>
                    <query>index=security "Failed password" OR "authentication failure" earliest=-24h | stats count</query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
                <option name="rangeValues">[5,20]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>‚úÖ Successful Logins (Last 24h)</title>
            <single>
                <search>
                    <query>index=security "Accepted" earliest=-24h | stats count</query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0x53a051","0x53a051"]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>üë• Unique Users</title>
            <single>
                <search>
                    <query>index=security earliest=-24h | rex "user\s+(?&lt;user&gt;\S+)" | stats dc(user)</query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
            </single>
        </panel>
    </row>

    <row>
        <panel>
            <title>Authentication Timeline</title>
            <chart>
                <search>
                    <query>
index=security earliest=-24h
| rex "(?&lt;action&gt;Accepted|Failed|Invalid)"
| timechart span=1h count by action
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">column</option>
                <option name="charting.chart.stackMode">stacked</option>
                <option name="charting.legend.placement">right</option>
                <option name="charting.fieldColors">{"Accepted": 0x53a051, "Failed": 0xdc4e41, "Invalid": 0xf8be34}</option>
            </chart>
        </panel>
    </row>

    <row>
        <panel>
            <title>Failed Login Attempts by Source IP</title>
            <table>
                <search>
                    <query>
index=security ("Failed password" OR "Invalid user") earliest=-24h
| rex "from\s+(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| rex "user\s+(?&lt;user&gt;\S+)"
| stats count by src_ip user host
| sort -count
| head 20
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
                <option name="count">10</option>
            </table>
        </panel>
        <panel>
            <title>Successful Logins by User</title>
            <table>
                <search>
                    <query>
index=security "Accepted" earliest=-24h
| rex "for\s+(?&lt;user&gt;\S+)\s+from\s+(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| stats count latest(_time) as last_login by user src_ip host
| convert ctime(last_login)
| sort -count
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
            </table>
        </panel>
    </row>

    <row>
        <panel>
            <title>Sudo Commands</title>
            <table>
                <search>
                    <query>
index=security sudo earliest=-24h
| rex "COMMAND=(?&lt;command&gt;.+)"
| rex "USER=(?&lt;target_user&gt;\S+)"
| rex "sudo:\s+(?&lt;user&gt;\S+)"
| table _time host user target_user command
| sort -_time
| head 20
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
            </table>
        </panel>
    </row>

    <row>
        <panel>
            <title>Security Events by Host</title>
            <chart>
                <search>
                    <query>
index=security earliest=-24h
| stats count by host
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">pie</option>
            </chart>
        </panel>
        <panel>
            <title>Recent Security Events</title>
            <table>
                <search>
                    <query>
index=security earliest=-1h
| table _time host sourcetype _raw
| sort -_time
| head 20
                    </query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>30s</refresh>
                </search>
                <option name="drilldown">none</option>
                <option name="wrap">true</option>
            </table>
        </panel>
    </row>
</dashboard>

