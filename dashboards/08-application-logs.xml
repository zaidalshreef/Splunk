<dashboard version="1.1" theme="dark">
    <label>Application Logs</label>
    <description>Docker Container Logs, Stdout/Stderr, Application Events</description>

    <row>
        <panel>
            <title>üì± Total Application Events (Last Hour)</title>
            <single>
                <search>
                    <query>index=docker sourcetype="docker:container:json" earliest=-1h | stats count</query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>30s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0x53a051","0x53a051"]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>‚ö†Ô∏è Errors</title>
            <single>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" earliest=-1h
| search "error" OR "Error" OR "ERROR" OR "exception" OR "Exception"
| stats count
                    </query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>30s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
                <option name="rangeValues">[10,50]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>üîî Warnings</title>
            <single>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" earliest=-1h
| search "warn" OR "Warn" OR "WARNING"
| stats count
                    </query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>30s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xf8be34"]</option>
                <option name="rangeValues">[20,100]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>üì¶ Active Containers Logging</title>
            <single>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" earliest=-15m
| stats dc(source)
                    </query>
                    <earliest>-15m</earliest>
                    <latest>now</latest>
                    <refresh>30s</refresh>
                </search>
            </single>
        </panel>
    </row>

    <row>
        <panel>
            <title>Application Events Over Time</title>
            <chart>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" earliest=-24h
| rex field=source "/var/lib/docker/containers/[^/]+/(?&lt;container_id&gt;[^-]+)"
| timechart span=1h count by container_id limit=15
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">area</option>
                <option name="charting.chart.stackMode">stacked</option>
                <option name="charting.legend.placement">right</option>
            </chart>
        </panel>
    </row>

    <row>
        <panel>
            <title>Error Logs</title>
            <table>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" earliest=-4h
| search "error" OR "Error" OR "ERROR" OR "exception" OR "Exception" OR "fail" OR "FAIL"
| rex field=source "/var/lib/docker/containers/(?&lt;container_id&gt;[^/]+)/"
| table _time container_id _raw
| sort -_time
| head 30
                    </query>
                    <earliest>-4h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
                <option name="wrap">true</option>
            </table>
        </panel>
    </row>

    <row>
        <panel>
            <title>Log Volume by Container</title>
            <chart>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" earliest=-24h
| rex field=source "/var/lib/docker/containers/(?&lt;container_id&gt;[^/]+)/"
| stats count by container_id
| sort -count
| head 15
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">bar</option>
            </chart>
        </panel>
        <panel>
            <title>Log Level Distribution</title>
            <chart>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" earliest=-24h
| rex "\"level\":\"(?&lt;log_level&gt;[^\"]+)\""
| eval log_level = if(isnull(log_level), "unknown", log_level)
| stats count by log_level
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">pie</option>
                <option name="charting.fieldColors">{"debug": 0x006d9c, "info": 0x53a051, "warn": 0xf8be34, "warning": 0xf8be34, "error": 0xdc4e41, "fatal": 0x9c0000, "unknown": 0x999999}</option>
            </chart>
        </panel>
    </row>

    <row>
        <panel>
            <title>Dokploy Service Logs</title>
            <table>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" dokploy earliest=-4h
| table _time source _raw
| sort -_time
| head 25
                    </query>
                    <earliest>-4h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
                <option name="wrap">true</option>
            </table>
        </panel>
    </row>

    <row>
        <panel>
            <title>Database Service Logs (PostgreSQL, MySQL, Redis, MongoDB)</title>
            <table>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" (postgres OR mysql OR redis OR mongo) earliest=-4h
| table _time source _raw
| sort -_time
| head 25
                    </query>
                    <earliest>-4h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
                <option name="wrap">true</option>
            </table>
        </panel>
    </row>

    <row>
        <panel>
            <title>Recent Application Logs</title>
            <table>
                <search>
                    <query>
index=docker sourcetype="docker:container:json" earliest=-1h
| rex field=source "/var/lib/docker/containers/(?&lt;container_id&gt;[^/]+)/"
| eval short_id = substr(container_id, 1, 12)
| table _time short_id _raw
| sort -_time
| head 50
                    </query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>30s</refresh>
                </search>
                <option name="drilldown">none</option>
                <option name="wrap">true</option>
                <option name="count">25</option>
            </table>
        </panel>
    </row>
</dashboard>

