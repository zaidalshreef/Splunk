<dashboard version="1.1" theme="dark">
    <label>Network Monitoring</label>
    <description>Network Connections, Firewall, DNS, Traffic Analysis</description>

    <row>
        <panel>
            <title>üåê Network Events (Last Hour)</title>
            <single>
                <search>
                    <query>
(index=security sourcetype=linux_audit key=network_connections) OR (index=linux (iptables OR ufw)) earliest=-1h
| stats count
                    </query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
            </single>
        </panel>
        <panel>
            <title>üîí Firewall Blocks</title>
            <single>
                <search>
                    <query>index=linux (iptables OR ufw) (DROP OR BLOCK OR DENY) earliest=-1h | stats count</query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
                <option name="rangeValues">[10,50]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>‚úÖ Allowed Connections</title>
            <single>
                <search>
                    <query>index=linux (iptables OR ufw) (ACCEPT OR ALLOW) earliest=-1h | stats count</query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
            </single>
        </panel>
        <panel>
            <title>üñ•Ô∏è Unique Source IPs</title>
            <single>
                <search>
                    <query>
index=linux (iptables OR ufw) earliest=-1h
| rex "SRC=(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| stats dc(src_ip)
                    </query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
            </single>
        </panel>
    </row>

    <row>
        <panel>
            <title>Firewall Events Over Time</title>
            <chart>
                <search>
                    <query>
index=linux (iptables OR ufw) earliest=-24h
| rex "(?&lt;action&gt;ACCEPT|ALLOW|DROP|BLOCK|DENY)"
| timechart span=1h count by action
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">column</option>
                <option name="charting.chart.stackMode">stacked</option>
                <option name="charting.legend.placement">right</option>
                <option name="charting.fieldColors">{"ACCEPT": 0x53a051, "ALLOW": 0x53a051, "DROP": 0xdc4e41, "BLOCK": 0xdc4e41, "DENY": 0xf8be34}</option>
            </chart>
        </panel>
    </row>

    <row>
        <panel>
            <title>Top Blocked Source IPs</title>
            <table>
                <search>
                    <query>
index=linux (iptables OR ufw) (DROP OR BLOCK OR DENY) earliest=-24h
| rex "SRC=(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| rex "DPT=(?&lt;dest_port&gt;\d+)"
| stats count by src_ip dest_port
| sort -count
| head 20
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
            </table>
        </panel>
        <panel>
            <title>Top Targeted Ports (Blocked)</title>
            <chart>
                <search>
                    <query>
index=linux (iptables OR ufw) (DROP OR BLOCK OR DENY) earliest=-24h
| rex "DPT=(?&lt;dest_port&gt;\d+)"
| stats count by dest_port
| sort -count
| head 15
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">bar</option>
            </chart>
        </panel>
    </row>

    <row>
        <panel>
            <title>SSH Connection Attempts by Source</title>
            <table>
                <search>
                    <query>
index=security sshd earliest=-24h
| rex "from\s+(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| rex "(?&lt;result&gt;Accepted|Failed|Invalid)"
| stats count(eval(result="Accepted")) as successful count(eval(result="Failed" OR result="Invalid")) as failed by src_ip
| eval total = successful + failed
| sort -total
| head 20
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
            </table>
        </panel>
        <panel>
            <title>Connection Types Distribution</title>
            <chart>
                <search>
                    <query>
index=linux (iptables OR ufw) earliest=-24h
| rex "PROTO=(?&lt;protocol&gt;\w+)"
| stats count by protocol
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">pie</option>
            </chart>
        </panel>
    </row>

    <row>
        <panel>
            <title>Outbound Connection Tracking</title>
            <table>
                <search>
                    <query>
index=security sourcetype=linux_audit key=network_connections earliest=-4h
| rex "saddr=(?&lt;remote_addr&gt;[A-Fa-f0-9]+)"
| table _time host remote_addr
| sort -_time
| head 25
                    </query>
                    <earliest>-4h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
            </table>
        </panel>
        <panel>
            <title>Recent Firewall Events</title>
            <table>
                <search>
                    <query>
index=linux (iptables OR ufw) earliest=-1h
| rex "SRC=(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| rex "DST=(?&lt;dst_ip&gt;\d+\.\d+\.\d+\.\d+)"
| rex "DPT=(?&lt;dest_port&gt;\d+)"
| rex "PROTO=(?&lt;proto&gt;\w+)"
| rex "(?&lt;action&gt;ACCEPT|ALLOW|DROP|BLOCK|DENY)"
| table _time host action proto src_ip dst_ip dest_port
| sort -_time
| head 20
                    </query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>30s</refresh>
                </search>
                <option name="drilldown">none</option>
            </table>
        </panel>
    </row>
</dashboard>

