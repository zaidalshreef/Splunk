<!--
Docker Swarm Overview Dashboard
===============================
Import this dashboard via Splunk Web:
1. Go to Search & Reporting > Dashboards
2. Click "Create New Dashboard"
3. Give it a name, select "Classic Dashboards"
4. Click "Source" and paste this XML
-->

<dashboard version="1.1" theme="dark">
  <label>Docker Swarm Overview</label>
  <description>Real-time monitoring of Docker Swarm cluster</description>
  
  <row>
    <panel>
      <title>Swarm Nodes</title>
      <table>
        <search>
          <query>
index=docker sourcetype="docker:swarm:node" earliest=-5m
| dedup hostname
| table hostname status availability manager_status
| rename hostname as "Node", status as "Status", availability as "Availability", manager_status as "Manager Status"
          </query>
          <earliest>-15m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
    
    <panel>
      <title>Swarm Services</title>
      <table>
        <search>
          <query>
index=docker sourcetype="docker:swarm:service" earliest=-5m
| dedup name
| table name mode replicas image
| rename name as "Service", mode as "Mode", replicas as "Replicas", image as "Image"
          </query>
          <earliest>-15m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  
  <row>
    <panel>
      <title>Container CPU Usage</title>
      <chart>
        <search>
          <query>
index=docker sourcetype="docker:stats" earliest=-30m
| rex field=cpu "(?&lt;cpu_pct&gt;[\d.]+)%"
| timechart avg(cpu_pct) by name limit=10
          </query>
          <earliest>-30m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleY.text">CPU %</option>
      </chart>
    </panel>
    
    <panel>
      <title>Container Memory Usage</title>
      <chart>
        <search>
          <query>
index=docker sourcetype="docker:stats" earliest=-30m
| rex field=mem_perc "(?&lt;mem_pct&gt;[\d.]+)%"
| timechart avg(mem_pct) by name limit=10
          </query>
          <earliest>-30m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="charting.chart">area</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleY.text">Memory %</option>
      </chart>
    </panel>
  </row>
  
  <row>
    <panel>
      <title>Running Containers</title>
      <table>
        <search>
          <query>
index=docker sourcetype="docker:container:status" earliest=-5m
| dedup names
| table names image status
| rename names as "Container", image as "Image", status as "Status"
          </query>
          <earliest>-15m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="drilldown">none</option>
        <option name="count">20</option>
      </table>
    </panel>
  </row>
  
  <row>
    <panel>
      <title>Events by Host</title>
      <chart>
        <search>
          <query>
index=* earliest=-1h
| timechart count by host
          </query>
          <earliest>-1h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
    
    <panel>
      <title>Events by Index</title>
      <chart>
        <search>
          <query>
index=* earliest=-1h
| stats count by index
| sort -count
          </query>
          <earliest>-1h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="charting.chart">pie</option>
      </chart>
    </panel>
  </row>
  
  <row>
    <panel>
      <title>Authentication Events</title>
      <table>
        <search>
          <query>
index=security sourcetype=linux_secure earliest=-1h
| rex "(?&lt;action&gt;Accepted|Failed|Invalid)"
| stats count by host action user src_ip
| sort -count
          </query>
          <earliest>-1h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="drilldown">none</option>
        <option name="count">10</option>
      </table>
    </panel>
    
    <panel>
      <title>System Errors</title>
      <table>
        <search>
          <query>
index=linux sourcetype=syslog (error OR fail OR critical) earliest=-1h
| stats count by host syslog_process
| sort -count
| head 10
          </query>
          <earliest>-1h</earliest>
          <latest>now</latest>
          <refresh>60s</refresh>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  
</dashboard>

