<dashboard version="1.1" theme="dark">
    <label>System Logs</label>
    <description>Syslog, Kernel, Daemon, Application Logs</description>

    <row>
        <panel>
            <title>üìã Total Events (Last Hour)</title>
            <single>
                <search>
                    <query>index=linux earliest=-1h | stats count</query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0x53a051","0x53a051"]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>‚ö†Ô∏è Errors</title>
            <single>
                <search>
                    <query>index=linux (error OR fail OR critical) earliest=-1h | stats count</query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
                <option name="rangeValues">[10,50]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>üîî Warnings</title>
            <single>
                <search>
                    <query>index=linux (warn OR warning) earliest=-1h | stats count</query>
                    <earliest>-1h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xf8be34"]</option>
                <option name="rangeValues">[20,100]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <title>üñ•Ô∏è Active Hosts</title>
            <single>
                <search>
                    <query>index=linux earliest=-15m | stats dc(host)</query>
                    <earliest>-15m</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="colorMode">block</option>
                <option name="rangeColors">["0xdc4e41","0xf8be34","0x53a051"]</option>
                <option name="rangeValues">[3,5]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
    </row>

    <row>
        <panel>
            <title>Events Over Time by Host</title>
            <chart>
                <search>
                    <query>
index=linux earliest=-24h
| timechart span=1h count by host
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">line</option>
                <option name="charting.legend.placement">right</option>
            </chart>
        </panel>
    </row>

    <row>
        <panel>
            <title>Events by Sourcetype</title>
            <chart>
                <search>
                    <query>
index=linux earliest=-24h
| stats count by sourcetype
| sort -count
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">pie</option>
            </chart>
        </panel>
        <panel>
            <title>Top Processes/Services</title>
            <chart>
                <search>
                    <query>
index=linux sourcetype=syslog earliest=-24h
| rex "^\w+\s+\d+\s+[\d:]+\s+\S+\s+(?&lt;process&gt;[^\[:]+)"
| stats count by process
| sort -count
| head 15
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="charting.chart">bar</option>
            </chart>
        </panel>
    </row>

    <row>
        <panel>
            <title>Error Messages</title>
            <table>
                <search>
                    <query>
index=linux (error OR fail OR critical) earliest=-4h
| rex "^\w+\s+\d+\s+[\d:]+\s+\S+\s+(?&lt;process&gt;[^\[:]+)"
| table _time host process _raw
| sort -_time
| head 30
                    </query>
                    <earliest>-4h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
                <option name="wrap">true</option>
            </table>
        </panel>
    </row>

    <row>
        <panel>
            <title>Kernel Messages</title>
            <table>
                <search>
                    <query>
index=linux sourcetype=linux_kernel earliest=-4h
| table _time host _raw
| sort -_time
| head 20
                    </query>
                    <earliest>-4h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
                <option name="wrap">true</option>
            </table>
        </panel>
    </row>

    <row>
        <panel>
            <title>Service Start/Stop Events</title>
            <table>
                <search>
                    <query>
index=linux (Started OR Stopped OR Starting OR Stopping OR systemd) earliest=-24h
| rex "(?&lt;action&gt;Started|Stopped|Starting|Stopping)\s+(?&lt;service&gt;.+)\."
| where isnotnull(action)
| stats count latest(_time) as last_event by host service action
| convert ctime(last_event)
| sort -last_event
| head 20
                    </query>
                    <earliest>-24h</earliest>
                    <latest>now</latest>
                    <refresh>60s</refresh>
                </search>
                <option name="drilldown">none</option>
            </table>
        </panel>
        <panel>
            <title>Package Changes (dpkg)</title>
            <table>
                <search>
                    <query>
index=linux sourcetype=dpkg earliest=-7d
| rex "^\S+\s+\S+\s+(?&lt;action&gt;\S+)\s+(?&lt;package&gt;\S+)"
| table _time host action package
| sort -_time
| head 20
                    </query>
                    <earliest>-7d</earliest>
                    <latest>now</latest>
                    <refresh>300s</refresh>
                </search>
                <option name="drilldown">none</option>
            </table>
        </panel>
    </row>
</dashboard>

