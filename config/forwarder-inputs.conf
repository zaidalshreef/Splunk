# =============================================================================
# Universal Forwarder - Inputs Configuration
# =============================================================================
# Deploy to: /opt/splunkforwarder/etc/system/local/inputs.conf
# Collects system logs and Docker container logs
# =============================================================================

[default]
host = $decideOnStartup

# =============================================================================
# System Logs
# =============================================================================

[monitor:///var/log/syslog]
disabled = false
index = linux
sourcetype = syslog

[monitor:///var/log/auth.log]
disabled = false
index = security
sourcetype = linux_secure

[monitor:///var/log/kern.log]
disabled = false
index = linux
sourcetype = linux_kernel

# =============================================================================
# Docker Container Logs (JSON files)
# =============================================================================
# Docker stores container logs in /var/lib/docker/containers/<id>/<id>-json.log
# These contain: {"log":"message","stream":"stdout/stderr","time":"timestamp"}

[monitor:///var/lib/docker/containers/*/*-json.log]
disabled = false
index = docker
sourcetype = docker:container:json
ignoreOlderThan = 3d

# =============================================================================
# Dokploy Application Logs (if using Dokploy)
# =============================================================================

[monitor:///etc/dokploy/logs/]
disabled = false
index = docker
sourcetype = dokploy:app
ignoreOlderThan = 7d

# =============================================================================
# Docker Metrics (from collector script)
# =============================================================================
# Collected by docker-metrics-collector.sh

[monitor:///var/log/docker-metrics.log]
disabled = false
index = docker
sourcetype = docker:metrics

# =============================================================================
# Traefik Access Logs
# =============================================================================

[monitor:///etc/dokploy/traefik/dynamic/access.log]
disabled = false
index = traefik
sourcetype = traefik:access
ignoreOlderThan = 7d

# =============================================================================
# Audit Logs (Security)
# =============================================================================

[monitor:///var/log/audit/audit.log]
disabled = false
index = security
sourcetype = linux_audit

# =============================================================================
# Network Security Metrics
# =============================================================================
# Collected by network-security-collector.sh

[monitor:///var/log/network-security.log]
disabled = false
index = network
sourcetype = network:security

