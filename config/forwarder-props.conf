# =============================================================================
# Universal Forwarder - Props Configuration
# =============================================================================
# Deploy to: /opt/splunkforwarder/etc/system/local/props.conf
# Basic parsing at forwarder level
# =============================================================================

# =============================================================================
# Docker Container JSON Logs
# =============================================================================
# Parse the Docker JSON wrapper to extract clean log messages

[docker:container:json]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_PREFIX = "time":"
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%9N
MAX_TIMESTAMP_LOOKAHEAD = 40
TRUNCATE = 0

# Extract log message content (stripping Docker JSON wrapper)
SEDCMD-strip_wrapper = s/^\{"log":"(.*)","stream":"(stdout|stderr)","time":"[^"]+"\}$/\1/
SEDCMD-unescape = s/\\n$// s/\\"/"/g s/\\\\/\\/g

# =============================================================================
# Docker Metrics
# =============================================================================

[docker:metrics]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%SZ
TIME_PREFIX = "timestamp":"
MAX_TIMESTAMP_LOOKAHEAD = 30

# =============================================================================
# System Logs
# =============================================================================

[syslog]
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 20
SHOULD_LINEMERGE = false

[linux_secure]
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 20
SHOULD_LINEMERGE = false

[linux_kernel]
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 20
SHOULD_LINEMERGE = false

# =============================================================================
# Traefik
# =============================================================================

[traefik:access]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
TIME_PREFIX = "time":"
MAX_TIMESTAMP_LOOKAHEAD = 30

