# =============================================================================
# Comprehensive Splunk Inputs Configuration
# =============================================================================
# Collects: SSH logs, login logs, command logs, network/port logs
# Deploy to: /opt/splunkforwarder/etc/apps/myinputs/local/inputs.conf

[default]
host = $HOSTNAME

# =============================================================================
# AUTHENTICATION & SSH LOGS
# =============================================================================

# Main authentication log (SSH logins, sudo, PAM)
[monitor:///var/log/auth.log]
disabled = false
index = security
sourcetype = linux_secure

# Secure log (RHEL/CentOS style)
[monitor:///var/log/secure]
disabled = false
index = security
sourcetype = linux_secure

# Failed login attempts
[monitor:///var/log/faillog]
disabled = false
index = security
sourcetype = faillog

# Last logins
[monitor:///var/log/lastlog]
disabled = false
index = security
sourcetype = lastlog

# Login records (who logged in)
[monitor:///var/log/wtmp]
disabled = false
index = security
sourcetype = wtmp

# Bad login attempts
[monitor:///var/log/btmp]
disabled = false
index = security
sourcetype = btmp

# =============================================================================
# SYSTEM LOGS
# =============================================================================

# Main system log
[monitor:///var/log/syslog]
disabled = false
index = linux
sourcetype = syslog

# Messages log (RHEL/CentOS style)
[monitor:///var/log/messages]
disabled = false
index = linux
sourcetype = syslog

# Kernel log
[monitor:///var/log/kern.log]
disabled = false
index = linux
sourcetype = linux_kernel

# Boot log
[monitor:///var/log/boot.log]
disabled = false
index = linux
sourcetype = linux_bootlog

# Daemon log
[monitor:///var/log/daemon.log]
disabled = false
index = linux
sourcetype = syslog

# Cron log
[monitor:///var/log/cron.log]
disabled = false
index = linux
sourcetype = cron

# =============================================================================
# AUDIT LOGS (Command execution, file access)
# =============================================================================

# Linux Audit daemon (tracks commands, file access, etc.)
[monitor:///var/log/audit/audit.log]
disabled = false
index = security
sourcetype = linux_audit

# =============================================================================
# NETWORK & FIREWALL LOGS
# =============================================================================

# UFW Firewall logs (port open/close, blocked connections)
[monitor:///var/log/ufw.log]
disabled = false
index = network
sourcetype = ufw

# IPTables/Netfilter logs (usually in kern.log or syslog)
# These are captured by syslog, but we can filter them

# Fail2ban logs (blocked IPs)
[monitor:///var/log/fail2ban.log]
disabled = false
index = security
sourcetype = fail2ban

# =============================================================================
# PACKAGE & SYSTEM CHANGES
# =============================================================================

# Package installation/removal
[monitor:///var/log/dpkg.log]
disabled = false
index = linux
sourcetype = dpkg

# APT package manager
[monitor:///var/log/apt/history.log]
disabled = false
index = linux
sourcetype = apt

# Yum/DNF package manager (RHEL/CentOS)
[monitor:///var/log/yum.log]
disabled = false
index = linux
sourcetype = yum

# =============================================================================
# DOCKER LOGS
# =============================================================================

# Docker daemon log
[monitor:///var/log/docker.log]
disabled = false
index = docker
sourcetype = docker:daemon

# Container logs (JSON format)
[monitor:///var/lib/docker/containers/*/*-json.log]
disabled = false
index = docker
sourcetype = docker:container:json
time_format = %Y-%m-%dT%H:%M:%S.%9N

# =============================================================================
# USER ACTIVITY LOGS (Bash History)
# =============================================================================

# Root bash history
[monitor:///root/.bash_history]
disabled = false
index = security
sourcetype = bash_history

# Track all users' bash history (if accessible)
[monitor:///home/*/.bash_history]
disabled = false
index = security
sourcetype = bash_history

# =============================================================================
# SYSTEMD JOURNAL (Optional - comprehensive system logs)
# =============================================================================

# If you want to collect from journald directly
# Uncomment and configure journald input

#[journald://default]
#disabled = false
#index = linux

# =============================================================================
# SUDO LOGS
# =============================================================================

# Sudo commands (usually in auth.log, but some systems have separate file)
[monitor:///var/log/sudo.log]
disabled = false
index = security
sourcetype = sudo

