# =============================================================================
# Splunk Enterprise - Docker Compose
# =============================================================================
# Fresh setup with HEC (HTTP Event Collector) enabled for Docker logs
# 
# Deploy to remote server:
#   scp docker-compose.yml root@10.10.10.114:/opt/splunk-deploy/
#   ssh root@10.10.10.114 'cd /opt/splunk-deploy && docker compose up -d'
#
# Web UI: http://10.10.10.114:8000
# Username: admin
# Password: SplunkAdmin123!
# HEC Token: a1b2c3d4-e5f6-7890-abcd-ef1234567890
# =============================================================================

services:
  splunk:
    image: splunk/splunk:latest
    container_name: splunk-enterprise
    hostname: splunk
    restart: unless-stopped
    ports:
      # Web UI
      - "8000:8000"
      # Splunk Forwarder receiving port
      - "9997:9997"
      # HTTP Event Collector (HEC)
      - "8088:8088"
      # Management port
      - "8089:8089"
    environment:
      - SPLUNK_START_ARGS=--accept-license
      - SPLUNK_GENERAL_TERMS=--accept-sgt-current-at-splunk-com
      - SPLUNK_PASSWORD=SplunkAdmin123!
      - SPLUNK_HEC_TOKEN=a1b2c3d4-e5f6-7890-abcd-ef1234567890
    volumes:
      # Persistent data
      - splunk-etc:/opt/splunk/etc
      - splunk-var:/opt/splunk/var
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 120s

volumes:
  splunk-etc:
  splunk-var:

