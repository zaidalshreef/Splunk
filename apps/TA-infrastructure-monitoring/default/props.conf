#
# Props.conf - Field extractions and parsing rules
#

# =============================================================================
# Docker Container Logs (JSON from Docker daemon)
# =============================================================================
[docker:container:json]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_PREFIX = "time":"
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%9N
MAX_TIMESTAMP_LOOKAHEAD = 40
TRUNCATE = 0
KV_MODE = json
EXTRACT-container_id = source::\/var\/lib\/docker\/containers\/(?<container_id>[a-f0-9]{64})\/
EXTRACT-container_short_id = source::\/var\/lib\/docker\/containers\/(?<container_short_id>[a-f0-9]{12})
EXTRACT-log_message = "log":"(?<log_message>.+)"
EXTRACT-stream = "stream":"(?<stream>[^"]+)"

# =============================================================================
# Network Security Metrics (JSON from collector)
# =============================================================================
[network:security]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%SZ
TIME_PREFIX = "timestamp":"
MAX_TIMESTAMP_LOOKAHEAD = 30

# =============================================================================
# Traefik Access Logs
# =============================================================================
[traefik:access]
SHOULD_LINEMERGE = false
TIME_FORMAT = %d/%b/%Y:%H:%M:%S %z
KV_MODE = json
EXTRACT-client_ip = ^(?<client_ip>\d+\.\d+\.\d+\.\d+)
EXTRACT-status_code = "OriginStatus":(?<status_code>\d+)
EXTRACT-request_duration = "Duration":(?<request_duration>\d+)
EXTRACT-request_path = "RequestPath":"(?<request_path>[^"]+)"
EXTRACT-request_method = "RequestMethod":"(?<request_method>[^"]+)"
EXTRACT-service_name = "ServiceName":"(?<service_name>[^"]+)"

[traefik:log]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S

# =============================================================================
# Linux System Logs
# =============================================================================
[syslog]
TIME_FORMAT = %b %d %H:%M:%S
SHOULD_LINEMERGE = false

[linux_secure]
TIME_FORMAT = %b %d %H:%M:%S
SHOULD_LINEMERGE = false
EXTRACT-auth_action = (?<auth_action>Accepted|Failed|Invalid|session opened|session closed)
EXTRACT-auth_user = for (?<auth_user>\S+)
EXTRACT-auth_src_ip = from (?<auth_src_ip>\d+\.\d+\.\d+\.\d+)

[linux_audit]
SHOULD_LINEMERGE = false
TIME_FORMAT = %s
TIME_PREFIX = msg=audit\(

